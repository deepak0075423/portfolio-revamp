<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <%
    const seoSafe = (typeof seo !== 'undefined' && seo && typeof seo === 'object') ? seo : {};
  %>
  <title><%= seoSafe.title ? seoSafe.title : site.meta.title %></title>
  <meta name="description" content="<%= seoSafe.description ? seoSafe.description : '' %>" />
  <link rel="canonical" href="<%= seoSafe.baseUrl ? (seoSafe.baseUrl + '/') : '/' %>" />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="<%= seoSafe.title ? seoSafe.title : '' %>" />
  <meta property="og:description" content="<%= seoSafe.description ? seoSafe.description : '' %>" />
  <meta property="og:url" content="<%= seoSafe.baseUrl ? (seoSafe.baseUrl + '/') : '' %>" />
  <% if (seoSafe.ogImage) { %>
    <meta property="og:image" content="<%= seoSafe.ogImage %>" />
  <% } %>

  <meta name="twitter:card" content="<%= seoSafe.ogImage ? 'summary_large_image' : 'summary' %>" />
  <meta name="twitter:title" content="<%= seoSafe.title ? seoSafe.title : '' %>" />
  <meta name="twitter:description" content="<%= seoSafe.description ? seoSafe.description : '' %>" />
  <% if (seoSafe.ogImage) { %>
    <meta name="twitter:image" content="<%= seoSafe.ogImage %>" />
  <% } %>

  <meta name="theme-color" content="#0a0a0f" />

  <link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" />
  <link rel="shortcut icon" href="/favicon.svg" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="stylesheet" href="/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

  <% if (seoSafe.jsonLdPerson) { %>
    <script type="application/ld+json"><%- JSON.stringify(seoSafe.jsonLdPerson) %></script>
  <% } %>
</head>
<body>
  <% const fullName = `${site.hero.firstName} ${site.hero.lastName}`; %>
  <%
    const isSectionEnabled = (id) => {
      const section = site && site[id];
      if (!section || typeof section !== 'object') return true;
      return section.enabled !== false;
    };
    const enabledNavLinks = (site.nav && Array.isArray(site.nav.links))
      ? site.nav.links.filter((l) => l && l.id && isSectionEnabled(l.id))
      : [];
    const firstNavId = enabledNavLinks.length ? enabledNavLinks[0].id : 'hero';
  %>

  <!-- Three.js Canvas -->
  <canvas id="bg-canvas"></canvas>

  <!-- Custom Cursor -->
  <div class="cursor"></div>
  <div class="cursor-follower"></div>

  <!-- Loader -->
  <div id="loader">
    <div class="loader-content">
      <div class="loader-text">
        <span>&lt;</span><%= fullName %><span>/&gt;</span>
      </div>
      <div class="loader-bar">
        <div class="loader-progress"></div>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <nav id="navbar">
    <div class="nav-logo">
      <a href="#<%= firstNavId %>"><%- site.nav.logoText %></a>
    </div>
    <ul class="nav-links">
      <% enabledNavLinks.forEach((l, idx) => { %>
        <li><a href="#<%= l.id %>" class="nav-link<%= idx === 0 ? ' active' : '' %>" data-section="<%= l.id %>"><%= l.label %></a></li>
      <% }) %>
    </ul>
    <div class="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div class="mobile-menu">
    <ul>
      <% enabledNavLinks.forEach((l) => { %>
        <li><a href="#<%= l.id %>" class="mobile-link"><%= l.label %></a></li>
      <% }) %>
    </ul>
  </div>

  <!-- Scroll Progress -->
  <div class="scroll-progress"></div>

  <main>
    <!-- ===== 1. HERO SECTION ===== -->
    <% if (isSectionEnabled('hero')) { %>
      <section id="hero">
        <canvas id="hero-globe-canvas"></canvas>
        <div class="hero-content">
          <div class="hero-greeting">
            <span class="line"></span>
            <span class="greeting-text"><%= site.hero.greeting %></span>
          </div>
          <h1 class="hero-name glitch" data-text="<%= fullName %>">
            <span class="first-name"><%= site.hero.firstName %></span>
            <span class="last-name"><%= site.hero.lastName %></span>
          </h1>
          <div class="hero-title-wrapper">
            <span class="hero-title-prefix">&gt; </span>
            <span class="hero-title" id="typed-text"></span>
            <span class="typed-cursor">|</span>
          </div>
          <p class="hero-description"><%= site.hero.description %></p>

          <div class="hero-cta">
            <% site.hero.ctas.forEach((cta) => { %>
              <a href="<%= cta.href %>" class="btn btn-<%= cta.style === 'primary' ? 'primary' : 'outline' %>">
                <span><%= cta.label %></span>
                <% if (cta.icon) { %><i class="<%= cta.icon %>"></i><% } %>
              </a>
            <% }) %>
          </div>

          <div class="hero-socials">
            <% site.hero.socials.forEach((s) => { %>
              <a href="<%= s.href %>" target="_blank" aria-label="<%= s.label %>"><i class="<%= s.icon %>"></i></a>
            <% }) %>
          </div>
        </div>
        <div class="scroll-indicator">
          <div class="mouse">
            <div class="wheel"></div>
          </div>
          <span><%= site.hero.scrollText %></span>
        </div>
      </section>
    <% } %>

    <!-- ===== 2. ABOUT SECTION ===== -->
    <% if (isSectionEnabled('about')) { %>
      <section id="about">
        <div class="section-container">
          <h2 class="section-title">
            <span class="title-number"><%= site.about.number %></span> <%= site.about.title %>
          </h2>
          <div class="about-grid">
            <div class="about-text">
              <% site.about.paragraphsHtml.forEach((p) => { %>
                <p><%- p %></p>
              <% }) %>

              <div class="about-info-grid">
                <% site.about.info.forEach((item) => { %>
                  <div class="info-item">
                    <span class="info-label"><%= item.label %></span>
                    <span class="info-value"><%= item.value %></span>
                  </div>
                <% }) %>
              </div>

              <a href="<%= site.about.resume.href %>" class="btn btn-primary">
                <span><%= site.about.resume.label %></span>
                <i class="<%= site.about.resume.icon %>"></i>
              </a>
            </div>

            <div class="about-stats">
              <% site.about.stats.forEach((s) => { %>
                <div class="stat-card" data-tilt>
                  <div class="stat-icon"><i class="<%= s.icon %>"></i></div>
                  <div class="stat-number" data-count="<%= s.count %>">0</div>
                  <% if (s.suffix) { %><div class="stat-suffix"><%= s.suffix %></div><% } %>
                  <div class="stat-label"><%= s.label %></div>
                </div>
              <% }) %>
            </div>
          </div>
        </div>
      </section>
    <% } %>

    <!-- ===== 3. TECH STACK SECTION ===== -->
    <% if (isSectionEnabled('techstack')) { %>
    <section id="techstack">
      <div class="section-container">
        <h2 class="section-title">
          <span class="title-number"><%= site.techstack.number %></span> <%= site.techstack.title %>
        </h2>
        <div class="techstack-grid">
          <% site.techstack.categories.forEach((cat) => { %>
            <div class="tech-category" data-tilt>
              <div class="tech-category-icon"><i class="<%= cat.icon %>"></i></div>
              <h3><%= cat.title %></h3>
              <div class="tech-items">
                <% cat.items.forEach((it) => { %>
                  <div class="tech-item"><i class="<%= it.icon %>"></i><span><%= it.label %></span></div>
                <% }) %>
              </div>
            </div>
          <% }) %>
        </div>

        <div class="skills-sphere-wrapper">
          <div class="skills-sphere" id="skills-sphere">
            <% site.techstack.sphereTags.forEach((tag, idx) => { %>
              <span style="--i:<%= idx + 1 %>"><%= tag %></span>
            <% }) %>
          </div>
        </div>
      </div>
    </section>
    <% } %>

    <!-- 3D Wave Divider -->
    <div class="wave-divider">
      <canvas id="wave-canvas"></canvas>
    </div>

    <!-- ===== 4. FEATURED PROJECTS SECTION ===== -->
    <% if (isSectionEnabled('projects')) { %>
    <section id="projects">
      <div class="section-container">
        <h2 class="section-title">
          <span class="title-number"><%= site.projects.number %></span> <%= site.projects.title %>
        </h2>
        <div class="project-filter">
          <% site.projects.filters.forEach((f, idx) => { %>
            <button class="filter-btn<%= idx === 0 ? ' active' : '' %>" data-filter="<%= f.value %>"><%= f.label %></button>
          <% }) %>
        </div>
        <div class="projects-grid">
          <% site.projects.cards.forEach((p) => { %>
            <div class="project-card" data-category="<%= p.category %>" data-tilt>
              <div class="project-card-inner">
                <div class="project-card-front">
                  <div class="project-icon"><i class="<%= p.frontIcon %>"></i></div>
                  <h3><%= p.frontTitle %></h3>
                  <p><%= p.frontDesc %></p>
                  <div class="project-tech">
                    <% p.tech.forEach((t) => { %><span><%= t %></span><% }) %>
                  </div>
                </div>
                <div class="project-card-back">
                  <h3><%= p.backTitle %></h3>
                  <p><%= p.backDesc %></p>
                  <div class="project-links">
                    <% if (p.link && p.link.type === 'status') { %>
                      <span class="project-status"><i class="<%= p.link.icon %>"></i> <%= p.link.label %></span>
                    <% } else if (p.link && p.link.href) { %>
                      <a href="<%= p.link.href %>" target="_blank" class="project-link"><i class="<%= p.link.icon %>"></i> <%= p.link.label %></a>
                    <% } %>
                  </div>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
      </div>
    </section>
    <% } %>

    <!-- ===== 5. ARCHITECTURE / CASE STUDIES SECTION ===== -->
    <% if (isSectionEnabled('casestudies')) { %>
    <section id="casestudies">
      <div class="section-container">
        <h2 class="section-title">
          <span class="title-number"><%= site.casestudies.number %></span> <%= site.casestudies.title %>
        </h2>
        <p class="section-subtitle"><%= site.casestudies.subtitle %></p>
        <div class="casestudies-grid">
          <% site.casestudies.cards.forEach((c) => { %>
            <div class="case-card">
              <div class="case-header">
                <div class="case-icon"><i class="<%= c.icon %>"></i></div>
                <div>
                  <h3><%= c.title %></h3>
                  <span class="case-tag"><%= c.tag %></span>
                </div>
              </div>
              <div class="case-body">
                <div class="case-section">
                  <h4><i class="fas fa-crosshairs"></i> Challenge</h4>
                  <p><%= c.challenge %></p>
                </div>
                <div class="case-section">
                  <h4><i class="fas fa-project-diagram"></i> Architecture</h4>
                  <div class="case-arch">
                    <% c.architecture.forEach((a, idx) => { %>
                      <span class="arch-tag"><%= a %></span>
                      <% if (idx < c.architecture.length - 1) { %>
                        <span class="arch-arrow"><i class="fas fa-long-arrow-alt-right"></i></span>
                      <% } %>
                    <% }) %>
                  </div>
                </div>
                <div class="case-section">
                  <h4><i class="fas fa-check-circle"></i> Impact</h4>
                  <ul class="case-impact">
                    <% c.impact.forEach((i) => { %><li><%= i %></li><% }) %>
                  </ul>
                </div>
              </div>
              <div class="case-tech-stack">
                <% c.tech.forEach((t) => { %><span><%= t %></span><% }) %>
              </div>
            </div>
          <% }) %>
        </div>
      </div>
    </section>
    <% } %>

    <!-- ===== 6. EXPERIENCE SECTION ===== -->
    <% if (isSectionEnabled('experience')) { %>
    <section id="experience">
      <div class="section-container">
        <h2 class="section-title">
          <span class="title-number"><%= site.experience.number %></span> <%= site.experience.title %>
        </h2>
        <div class="timeline">
          <% site.experience.items.forEach((item) => { %>
            <div class="timeline-item">
              <div class="timeline-dot"></div>
              <div class="timeline-content" data-tilt>
                <div class="timeline-header">
                  <div>
                    <h3><%= item.role %></h3>
                    <h4><i class="fas fa-building"></i> <%= item.company %></h4>
                  </div>
                  <div class="timeline-meta">
                    <span class="timeline-date"><i class="fas fa-calendar-alt"></i> <%= item.date %></span>
                    <span class="timeline-location"><i class="fas fa-map-marker-alt"></i> <%= item.location %></span>
                  </div>
                </div>
                <ul class="timeline-details">
                  <% item.details.forEach((d) => { %><li><%= d %></li><% }) %>
                </ul>
                <div class="timeline-tags">
                  <% item.tags.forEach((t) => { %><span><%= t %></span><% }) %>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
      </div>
    </section>
    <% } %>

    <!-- ===== 7. CERTIFICATIONS SECTION ===== -->
    <% if (isSectionEnabled('certifications')) { %>
    <section id="certifications">
      <div class="section-container">
        <h2 class="section-title">
          <span class="title-number"><%= site.certifications.number %></span> <%= site.certifications.title %>
        </h2>
        <div class="certifications-grid">
          <% site.certifications.cards.forEach((c) => { %>
            <div class="cert-card" data-tilt>
              <div class="cert-ribbon<%= c.ribbon && c.ribbon.variant ? ' ' + c.ribbon.variant : '' %>"><%= c.ribbon.text %></div>
              <div class="cert-icon"><i class="<%= c.icon %>"></i></div>
              <h3><%= c.title %></h3>
              <p><%= c.desc %></p>
              <div class="cert-meta">
                <% c.meta.forEach((m) => { %>
                  <span><i class="<%= m.icon %>"></i> <%= m.text %></span>
                <% }) %>
              </div>
            </div>
          <% }) %>
        </div>
      </div>
    </section>
    <% } %>

    <!-- ===== 8. BLOG SECTION ===== -->
    <% if (isSectionEnabled('blog')) { %>
    <section id="blog">
      <div class="section-container">
        <h2 class="section-title">
          <span class="title-number"><%= site.blog.number %></span> <%= site.blog.title %>
        </h2>
        <p class="section-subtitle"><%= site.blog.subtitle %></p>
        <div class="blog-grid">
          <% site.blog.posts.forEach((b) => { %>
            <article class="blog-card" data-tilt>
              <div class="blog-image">
                <div class="blog-image-placeholder"><i class="<%= b.icon %>"></i></div>
                <span class="blog-category"><%= b.category %></span>
              </div>
              <div class="blog-content">
                <div class="blog-date"><i class="fas fa-calendar-alt"></i> <%= b.date %></div>
                <h3><%= b.title %></h3>
                <p><%= b.excerpt %></p>
                <a href="<%= b.href %>" class="blog-read-more">Read More <i class="fas fa-arrow-right"></i></a>
              </div>
            </article>
          <% }) %>
        </div>
      </div>
    </section>
    <% } %>

    <!-- ===== 9. GITHUB SECTION ===== -->
    <% if (isSectionEnabled('github')) { %>
      <section id="github">
        <div class="section-container">
          <h2 class="section-title">
            <span class="title-number"><%= site.github.number %></span> <%= site.github.title %>
          </h2>
          <div class="github-wrapper">
            <div class="github-profile" data-tilt>
              <div class="github-avatar">
                <i class="fab fa-github"></i>
              </div>
              <div class="github-info">
                <h3><%= site.github.username %></h3>
                <p><%= site.github.tagline %></p>
                <a href="<%= site.github.profileUrl %>" target="_blank" class="btn btn-outline btn-sm">
                  <i class="fab fa-github"></i> View Profile
                </a>
              </div>
              <div class="github-stats-row">
                <% site.github.stats.forEach((s) => { %>
                  <div class="gh-stat">
                    <i class="<%= s.icon %>"></i>
                    <span class="gh-stat-num"><%= s.value %></span>
                    <span class="gh-stat-label"><%= s.label %></span>
                  </div>
                <% }) %>
              </div>
            </div>

            <div class="github-repos" data-tilt>
              <h3 class="repos-heading"><i class="fas fa-bookmark"></i> Pinned Repositories</h3>
              <div class="repos-grid">
                <% site.github.pinned.forEach((r) => { %>
                  <a href="<%= r.href %>" target="_blank" class="repo-card">
                    <div class="repo-header">
                      <i class="<%= r.icon %>"></i>
                      <h4><%= r.name %></h4>
                    </div>
                    <p><%= r.desc %></p>
                    <div class="repo-footer">
                      <span class="repo-lang"><span class="lang-dot <%= r.lang.class %>"></span> <%= r.lang.name %></span>
                      <span class="repo-stars"><i class="fas fa-star"></i> <%= r.stars %></span>
                    </div>
                  </a>
                <% }) %>
              </div>
            </div>
          </div>
        </div>
      </section>
    <% } %>

    <!-- ===== 10. CONTACT SECTION ===== -->
    <% if (isSectionEnabled('contact')) { %>
    <section id="contact">
      <div class="section-container">
        <h2 class="section-title">
          <span class="title-number"><%= site.contact.number %></span> <%= site.contact.title %>
        </h2>
        <div class="contact-grid">
          <div class="contact-info">
            <p class="contact-description"><%= site.contact.description %></p>
            <div class="contact-details">
              <% site.contact.details.forEach((d) => { %>
                <div class="contact-item">
                  <div class="contact-icon"><i class="<%= d.icon %>"></i></div>
                  <div>
                    <span class="contact-label"><%= d.label %></span>
                    <% if (d.href) { %>
                      <a href="<%= d.href %>"><%= d.value %></a>
                    <% } else { %>
                      <span><%= d.value %></span>
                    <% } %>
                  </div>
                </div>
              <% }) %>
            </div>
            <div class="contact-socials">
              <% site.contact.socials.forEach((s) => { %>
                <a href="<%= s.href %>" target="_blank" class="social-link" aria-label="<%= s.label %>">
                  <i class="<%= s.icon %>"></i>
                </a>
              <% }) %>
            </div>
          </div>
          <form class="contact-form" id="contact-form">
            <div class="form-group">
              <input type="text" id="name" name="name" placeholder=" " required />
              <label for="name"><%= site.contact.form.nameLabel %></label>
              <span class="form-line"></span>
            </div>
            <div class="form-group">
              <input type="email" id="email" name="email" placeholder=" " required />
              <label for="email"><%= site.contact.form.emailLabel %></label>
              <span class="form-line"></span>
            </div>
            <div class="form-group">
              <input type="text" id="subject" name="subject" placeholder=" " required />
              <label for="subject"><%= site.contact.form.subjectLabel %></label>
              <span class="form-line"></span>
            </div>
            <div class="form-group">
              <textarea id="message" name="message" rows="5" placeholder=" " required></textarea>
              <label for="message"><%= site.contact.form.messageLabel %></label>
              <span class="form-line"></span>
            </div>
            <button type="submit" class="btn btn-primary btn-submit">
              <span><%= site.contact.form.buttonLabel %></span>
              <i class="fas fa-paper-plane"></i>
            </button>
          </form>
        </div>
      </div>
    </section>
    <% } %>
  </main>

  <!-- Footer -->
  <% if (isSectionEnabled('footer')) { %>
    <footer>
      <div class="footer-content">
        <div class="footer-logo"><%- site.footer.logoText %></div>
        <p><%= site.footer.line1 %></p>
        <div class="footer-links">
          <% site.footer.links.forEach((l) => { %>
            <a href="<%= l.href %>" target="_blank" aria-label="<%= l.label %>"><i class="<%= l.icon %>"></i></a>
          <% }) %>
        </div>
        <p class="copyright">&copy; <%= nowYear %> <%= fullName %>. All Rights Reserved.</p>
      </div>
    </footer>
  <% } %>

  <script>window.__SITE__ = <%- JSON.stringify(site) %>;</script>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="/script.js"></script>
</body>
</html>
